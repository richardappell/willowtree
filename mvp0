# Let's prepare the structure of a backend stub using Claude Haiku via Anthropic's API.
# Since actual API calls aren't possible in this environment, we will simulate the API request payload.

# Sample user input data
story_input = {
    "child_name": "Ava",
    "child_age": 6,
    "emotion_or_theme": "starting a new school and feeling anxious",
    "tone": "magical",
    "favourite_thing": "unicorns",
    "selected_books": ["Room on the Broom", "The Gruffalo"],
    "word_count": 400
}

# Create the system prompt and user prompt
system_prompt = (
    "You are a master children’s storyteller who writes gentle, age-appropriate stories to help "
    "children process emotions and life changes. Your stories use metaphor, magic, and relatable animal or "
    "child characters. You understand child development and always write in a reassuring, emotionally safe tone for the child’s age."
)

user_prompt = f"""
Write a short story for a {story_input['child_age']}-year-old child named {story_input['child_name']}.

The story should:
- Help them process: {story_input['emotion_or_theme']}
- Use a tone that is: {story_input['tone']}
- Include: {story_input['favourite_thing']}
- Be written in the style of: {', '.join(story_input['selected_books'])}

The story should be:
- No longer than {story_input['word_count']} words
- Age-appropriate in vocabulary
- Gentle and hopeful in message
- Include a clear beginning, middle, and end
- Optionally include a moral or lesson if suitable

End the story with a comforting sentence like: "And that night, they slept peacefully under the stars."
"""

# Simulated Anthropic API payload for Claude Haiku
claude_haiku_payload = {
    "model": "claude-3-haiku-20240307",
    "system": system_prompt,
    "messages": [
        {"role": "user", "content": user_prompt}
    ],
    "max_tokens": 1000,
    "temperature": 0.8
}

claude_haiku_payload  # Return the simulated payload for Claude Haiku API call.
